using System;
using System.Collections.Generic;
using System.Globalization;

namespace ShodanNET.Objects
{
    public class Exploit
    {
        public Exploit(IDictionary<string, object> result)
        {
            CultureInfo provider = CultureInfo.InvariantCulture;

            // Extract the info out of the host dictionary and put it in the local properties
            Id = int.Parse(result["id"].ToString());
            Author = result["author"] as string;
            Date = DateTime.ParseExact((string)result["date"], "dd.MM.yyyy", provider);
            Description = result["description"] as string;
            Platform = result["platform"] as string;
            Port = int.Parse(result["port"].ToString());
            Type = result["type"] as string;
            CVE = result["type"] as string;
        }

        public int Id { get; set; }
        public string Author { get; set; }
        public DateTime Date { get; set; }
        public string Description { get; set; }
        public string Platform { get; set; }
        public int Port { get; set; }
        public string Type { get; set; }
        public string CVE { get; set; }
    }
}